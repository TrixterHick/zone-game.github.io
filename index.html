<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –°—Ç–∞–ª–∫–µ—Ä–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background-color: #1a1a1a;
            color: #00ff00;
            font-family: 'Courier New', Courier, monospace;
            padding: 20px;
            margin: 0;
        }
        h1 { text-align: center; border-bottom: 2px solid #00ff00; padding-bottom: 10px; }
        .stats { background: #2b2b2b; padding: 10px; margin-bottom: 20px; border-radius: 5px; }
        .item-list { display: grid; gap: 10px; }
        .item {
            background: #333;
            border: 1px solid #00ff00;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 5px;
        }
        .btn {
            background: #005500;
            color: white;
            border: none;
            padding: 8px 15px;
            cursor: pointer;
            font-family: inherit;
            border-radius: 3px;
        }
        .btn:active { background: #00ff00; color: black; }
    </style>
</head>
<body>
    <h1>üéí –†—é–∫–∑–∞–∫</h1>
    
    <div class="stats" id="stats-block">
        –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
    </div>

    <div class="item-list" id="items-container">
        </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞—Å–∫—Ä—ã—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞–ª –±–æ—Ç —á–µ—Ä–µ–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: ?inventory={"–ê–ø—Ç–µ—á–∫–∞":2,"–ù–æ–∂":1}&stats={"hp":100,"money":50}
        const inventoryData = JSON.parse(urlParams.get('inventory') || '{}');
        const statsData = JSON.parse(urlParams.get('stats') || '{}');

        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Ç–∞—Ç—ã
        document.getElementById('stats-block').innerHTML = `
            ‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ: ${statsData.health || 0}<br>
            üí∞ –î–µ–Ω—å–≥–∏: ${statsData.money || 0}<br>
            üí™ –£—Ä–æ–Ω: ${statsData.damage || 0}
        `;

        const container = document.getElementById('items-container');

        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã
        for (const [name, count] of Object.entries(inventoryData)) {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'item';
            
            // –õ–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–æ–∫
            let actionBtn = '';
            if (name === '–ê–ø—Ç–µ—á–∫–∞') {
                actionBtn = `<button class="btn" onclick="useItem('${name}')">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button>`;
            } else if (['–°—Ç–∞—Ä—ã–π –ø–∏—Å—Ç–æ–ª–µ—Ç', '–ü—Ä–æ—Å—Ç–æ–π –±—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç'].includes(name)) {
                actionBtn = `<button class="btn" onclick="equipItem('${name}')">–≠–∫–∏–ø–∏—Ä–æ–≤–∞—Ç—å</button>`;
            }

            itemDiv.innerHTML = `
                <span>${name} (x${count})</span>
                ${actionBtn}
            `;
            container.appendChild(itemDiv);
        }

        if (Object.keys(inventoryData).length === 0) {
            container.innerHTML = '<div style="text-align:center">–†—é–∫–∑–∞–∫ –ø—É—Å—Ç...</div>';
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞—Ç–Ω–æ –±–æ—Ç—É
        function useItem(item) {
            tg.sendData(JSON.stringify({action: 'use_item', item: item}));
        }

        function equipItem(item) {
            tg.sendData(JSON.stringify({action: 'equip_item', item: item}));
        }
    </script>
</body>
</html>
